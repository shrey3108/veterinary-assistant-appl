<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register - Veterinary Assistant</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 2rem 0;
        }
        .register-container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            max-width: 800px;
            width: 90%;
            margin: auto;
        }
        .register-header {
            text-align: center;
            margin-bottom: 2rem;
        }
        .register-header i {
            font-size: 3rem;
            color: #2193b0;
            margin-bottom: 1rem;
        }
        .form-control:focus {
            box-shadow: none;
            border-color: #2193b0;
        }
        .btn-register {
            background: linear-gradient(45deg, #2193b0, #6dd5ed);
            border: none;
            color: white;
            padding: 0.8rem;
            border-radius: 5px;
            width: 100%;
            font-weight: bold;
            margin-top: 1rem;
        }
        .btn-register:hover {
            background: linear-gradient(45deg, #1c7a94, #5bb8d0);
            transform: translateY(-1px);
        }
        .login-link {
            text-align: center;
            margin-top: 1rem;
        }
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }
        .form-section {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 1rem;
        }
        .form-section h4 {
            color: #2193b0;
            margin-bottom: 1rem;
        }
    </style>
</head>
<body>
    <div class="toast-container"></div>
    <div class="container">
        <div class="register-container">
            <div class="register-header">
                <i class="fas fa-stethoscope"></i>
                <h2>Create Account</h2>
                <p class="text-muted">Register for a new account</p>
            </div>
            <form id="registerForm">
                <!-- Personal Information -->
                <div class="form-section">
                    <h4><i class="fas fa-user"></i> Personal Information</h4>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Full Name</label>
                            <input type="text" class="form-control" id="fullName" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Username</label>
                            <input type="text" class="form-control" id="username" required>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12 mb-3">
                            <label class="form-label">Email</label>
                            <input type="email" class="form-control" id="email" required>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Password</label>
                            <div class="input-group">
                                <input type="password" class="form-control" id="password" required>
                                <button class="btn btn-outline-secondary" type="button" onclick="togglePassword('password')">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Confirm Password</label>
                            <div class="input-group">
                                <input type="password" class="form-control" id="confirmPassword" required>
                                <button class="btn btn-outline-secondary" type="button" onclick="togglePassword('confirmPassword')">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Location Information -->
                <div class="form-section">
                    <h4><i class="fas fa-map-marker-alt"></i> Location Information</h4>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">State</label>
                            <select class="form-select" id="state" required>
                                <option value="">Select State</option>
                                <option value="Andhra Pradesh">Andhra Pradesh</option>
                                <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                <option value="Assam">Assam</option>
                                <option value="Bihar">Bihar</option>
                                <option value="Chhattisgarh">Chhattisgarh</option>
                                <option value="Goa">Goa</option>
                                <option value="Gujarat">Gujarat</option>
                                <option value="Haryana">Haryana</option>
                                <option value="Himachal Pradesh">Himachal Pradesh</option>
                                <option value="Jharkhand">Jharkhand</option>
                                <option value="Karnataka">Karnataka</option>
                                <option value="Kerala">Kerala</option>
                                <option value="Madhya Pradesh">Madhya Pradesh</option>
                                <option value="Maharashtra">Maharashtra</option>
                                <option value="Manipur">Manipur</option>
                                <option value="Meghalaya">Meghalaya</option>
                                <option value="Mizoram">Mizoram</option>
                                <option value="Nagaland">Nagaland</option>
                                <option value="Odisha">Odisha</option>
                                <option value="Punjab">Punjab</option>
                                <option value="Rajasthan">Rajasthan</option>
                                <option value="Sikkim">Sikkim</option>
                                <option value="Tamil Nadu">Tamil Nadu</option>
                                <option value="Telangana">Telangana</option>
                                <option value="Tripura">Tripura</option>
                                <option value="Uttar Pradesh">Uttar Pradesh</option>
                                <option value="Uttarakhand">Uttarakhand</option>
                                <option value="West Bengal">West Bengal</option>
                                <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                <option value="Chandigarh">Chandigarh</option>
                                <option value="Dadra and Nagar Haveli and Daman and Diu">Dadra and Nagar Haveli and Daman and Diu</option>
                                <option value="Delhi">Delhi</option>
                                <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                                <option value="Ladakh">Ladakh</option>
                                <option value="Lakshadweep">Lakshadweep</option>
                                <option value="Puducherry">Puducherry</option>
                            </select>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">District</label>
                            <input type="text" class="form-control" id="district" required>
                        </div>
                    </div>
                </div>

                <!-- Livestock Information -->
                <div class="form-section">
                    <h4><i class="fas fa-horse"></i> Livestock Information</h4>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Total Livestock Count</label>
                            <input type="number" class="form-control" id="totalLivestock" min="0" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Farm Size (in acres)</label>
                            <input type="number" class="form-control" id="farmSize" min="0" step="0.1">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Cows</label>
                            <input type="number" class="form-control livestock-count" id="cowCount" min="0" value="0">
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Buffaloes</label>
                            <input type="number" class="form-control livestock-count" id="buffaloCount" min="0" value="0">
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Goats</label>
                            <input type="number" class="form-control livestock-count" id="goatCount" min="0" value="0">
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Sheep</label>
                            <input type="number" class="form-control livestock-count" id="sheepCount" min="0" value="0">
                        </div>
                    </div>
                </div>

                <button type="submit" class="btn btn-register">Register</button>
            </form>
            <div class="login-link">
                <p>Already have an account? <a href="/login">Login here</a></p>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function showToast(message, type = 'error') {
            const toastContainer = document.querySelector('.toast-container');
            const toastHtml = `
                <div class="toast" role="alert" aria-live="assertive" aria-atomic="true">
                    <div class="toast-header ${type === 'error' ? 'bg-danger' : 'bg-success'} text-white">
                        <strong class="me-auto">${type === 'error' ? 'Error' : 'Success'}</strong>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast"></button>
                    </div>
                    <div class="toast-body">${message}</div>
                </div>
            `;
            toastContainer.insertAdjacentHTML('beforeend', toastHtml);
            const toast = new bootstrap.Toast(toastContainer.lastElementChild);
            toast.show();
        }

        function togglePassword(inputId) {
            const input = document.getElementById(inputId);
            const type = input.getAttribute('type') === 'password' ? 'text' : 'password';
            input.setAttribute('type', type);
            const icon = event.currentTarget.querySelector('i');
            icon.classList.toggle('fa-eye');
            icon.classList.toggle('fa-eye-slash');
        }

        // Auto-calculate total livestock
        document.querySelectorAll('.livestock-count').forEach(input => {
            input.addEventListener('input', () => {
                const total = [...document.querySelectorAll('.livestock-count')]
                    .reduce((sum, input) => sum + (parseInt(input.value) || 0), 0);
                document.getElementById('totalLivestock').value = total;
            });
        });

        // Handle form submission
        document.getElementById('registerForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            // Validate passwords match
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            if (password !== confirmPassword) {
                showToast('Passwords do not match');
                return;
            }

            const formData = {
                fullName: document.getElementById('fullName').value,
                username: document.getElementById('username').value,
                email: document.getElementById('email').value,
                password: password,
                state: document.getElementById('state').value,
                district: document.getElementById('district').value,
                farmSize: parseFloat(document.getElementById('farmSize').value) || 0,
                livestock: {
                    total: parseInt(document.getElementById('totalLivestock').value) || 0,
                    cows: parseInt(document.getElementById('cowCount').value) || 0,
                    buffaloes: parseInt(document.getElementById('buffaloCount').value) || 0,
                    goats: parseInt(document.getElementById('goatCount').value) || 0,
                    sheep: parseInt(document.getElementById('sheepCount').value) || 0
                }
            };

            try {
                const response = await fetch('/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });

                const data = await response.json();
                if (data.success) {
                    showToast('Registration successful! Redirecting to login...', 'success');
                    setTimeout(() => window.location.href = '/login', 1500);
                } else {
                    showToast(data.error || 'Registration failed');
                }
            } catch (error) {
                showToast('Error connecting to server');
            }
        });
    </script>
</body>
</html>
